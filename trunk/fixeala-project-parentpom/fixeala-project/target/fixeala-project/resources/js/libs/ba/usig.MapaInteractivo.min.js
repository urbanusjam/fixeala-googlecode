jQuery.extendIf=function(b,d){if(b&&d){for(var a in d){if(typeof b[a]=="undefined"){b[a]=d[a]}}}return b};if(typeof(Ext)=="undefined"){jQuery.extend(Function.prototype,{createCallback:function(){var a=arguments;var b=this;return function(){return b.apply(window,a)}},createDelegate:function(c,b,a){var d=this;return function(){var f=b||arguments;if(a===true){f=Array.prototype.slice.call(arguments,0);f=f.concat(b)}else{if(typeof a=="number"){f=Array.prototype.slice.call(arguments,0);var e=[a,0].concat(b);Array.prototype.splice.apply(f,e)}}return d.apply(c||window,f)}},defer:function(c,e,b,a){var d=this.createDelegate(e,b,a);if(c){return setTimeout(d,c)}d();return 0},createSequence:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){var d=c.apply(this||window,arguments);b.apply(a||this||window,arguments);return d}},createInterceptor:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){b.target=this;b.method=c;if(b.apply(a||this||window,arguments)===false){return}return c.apply(this||window,arguments)}}});jQuery.extendIf(String,{escape:function(a){return a.replace(/('|\\)/g,"\\$1")},leftPad:function(d,b,c){var a=new String(d);if(!c){c=" "}while(a.length<b){a=c+a}return a.toString()},format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})}})}String.prototype.isInteger=function(){return !isNaN(parseInt(this))};String.prototype.isFloat=function(){return !isNaN(parseFloat(this))};String.prototype.toggle=function(b,a){return this==b?a:b};String.prototype.trim=function(){var a=/^\s+|\s+$/g;return function(){return this.replace(a,"")}}();String.prototype.translate=function(d,c){if(!(d.length&&c.length)||d.length!=c.length){return this}var b=this;for(var a=0;a<d.length;a++){if(typeof(d)=="string"){b=b.replace(new RegExp(d.charAt(a),"g"),c.charAt(a))}else{b=b.replace(new RegExp(d[a],"g"),c[a])}}return b};String.prototype.isDigit=function(){return/^\d+$/.test(this)};String.prototype.removeWords=function(e){var d=this.split(" ");var c=new Array();for(var b=0;b<d.length;b++){c.push(d[b]);for(var a=0;a<e.length;a++){if(c[b]==e[a]){c.pop();break}}}return c.join(" ")};jQuery.extendIf(Number.prototype,{constrain:function(b,a){return Math.min(Math.max(this,b),a)},isInteger:function(){return !isNaN(parseInt(this))},isFloat:function(){return !isNaN(parseFloat(this))}});jQuery.extendIf(Array.prototype,{indexOf:function(c){for(var b=0,a=this.length;b<a;b++){if(this[b]==c){return b}}return -1},removeObject:function(b){var a=this.indexOf(b);if(a!=-1){this.splice(a,1)}return this},binarySearch:function binarySearch(f,b){var a=0,e=this.length-1,c,d;while(a<=e){c=parseInt((a+e)/2,10);d=b(this[c],f);if(d<0){a=c+1;continue}if(d>0){e=c-1;continue}return c}return -1},inject:function(c,b){for(var a=0;a<this.length;a++){c=b(c,this[a],a)}return c},map:function(d,c){var a=new Array(this.length);for(var b=0,e=this.length;b<e;b++){if(b in this){a[b]=d.call(c,this[b],b,this)}}return a},intersect:function(){if(!arguments.length){return[]}var e=this;var d=a2=null;var h=0;while(h<arguments.length){d=[];a2=arguments[h];var c=e.length;var b=a2.length;for(var g=0;g<c;g++){for(var f=0;f<b;f++){if(e[g]===a2[f]){d.push(e[g])}}}e=d;h++}return d.unique()},unique:function(){var c=[];var b=this.length;for(var e=0;e<b;e++){for(var d=e+1;d<b;d++){if(this[e]===this[d]){d=++e}}c.push(this[e])}return c}});Date.prototype.getElapsed=function(a){return Math.abs((a||new Date()).getTime()-this.getTime())};if(typeof(usig)=="undefined"){usig={}}usig.debug=function(a){if(window.console&&window.console.log){window.console.log(a)}};if(typeof(usig)=="undefined"){usig={}}jQuery.extendIf(usig,{loadingJs:[],loadingJsListeners:{},__callLoadJsListeners:function(b){for(var c=0,a=usig.loadingJsListeners[b].length;c<a;c++){usig.loadingJsListeners[b][c]()}},loadJs:function(b,e){if(usig.loadingJs.indexOf(b)<0){usig.loadingJs.push(b);usig.loadingJsListeners[b]=(typeof(e)=="function")?[e]:[];var a=document.createElement("script"),c=document.getElementsByTagName("head")[0],d=false;a.onload=a.onreadystatechange=function(){if((a.readyState&&a.readyState!=="complete"&&a.readyState!=="loaded")||d){return false}a.onload=a.onreadystatechange=null;d=true;usig.__callLoadJsListeners(b)};a.src=b;c.insertBefore(a,c.firstChild)}else{usig.loadingJsListeners[b].push(e)}},loadCss:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}},removeJs:function(a){var c=document.getElementsByTagName("script");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("src")!=null&&c[b].getAttribute("src").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},removeCss:function(a){var c=document.getElementsByTagName("link");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("href")!=null&&c[b].getAttribute("href").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},Animator:function(c,d,e,f){var b=0;function a(){if(c.length>b){d(c[b]);b++;setTimeout(a,e)}else{if(typeof(f)=="function"){f()}}}this.stop=function(){b=c.length+1};a()},parseUri:function(e){var a=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"],b=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?").exec(e),d={};for(var c=0;c<10;c++){d[a[c]]=(b[c]?b[c]:"")}if(d.directoryPath.length>0){d.directoryPath=d.directoryPath.replace(/\/?$/,"/")}return d},registeredSuggesters:{},registerSuggester:function(a,b){usig.registeredSuggesters[a]=b},createSuggester:function(b,a){if(typeof(usig.registeredSuggesters[b])!="function"){throw"Suggester "+b+" is not registered.";return null}return new usig.registeredSuggesters[b](a)}});if(typeof(usig)=="undefined"){usig={}}usig.MapaInteractivo=(function(a){return function(r,f){var s=a.extend({},usig.MapaInteractivo.defaults,f),E=a("#"+r),D=parseInt(E.css("width")),w=parseInt(E.css("height")),k={},d={},p={},z=null,h=false,A=false,v=this,q=null,y=[],b=a('<div class="indicator" style="-moz-border-radius-topleft: 10px; -webkit-border-top-left-radius: 10px; -moz-border-radius-topright: 10px; -webkit-border-top-right-radius: 10px; -moz-border-radius-bottomleft: 10px; -webkit-border-bottom-left-radius: 10px; -moz-border-radius-bottomright: 10px; -webkit-border-bottom-right-radius: 10px;"></div>'),F=navBar=panZoomBar=scalebar=overviewMap=statusBar=markersShadows=myMarkers=null;function C(){b.remove();s.OpenLayersOptions.maxExtent=new OpenLayers.Bounds(s.bounds[0],s.bounds[1],s.bounds[2],s.bounds[3]);s.OpenLayersOptions.initBounds=new OpenLayers.Bounds(s.initBounds[0],s.initBounds[1],s.initBounds[2],s.initBounds[3]);F=new OpenLayers.Map(r,s.OpenLayersOptions);this.api=F;this.api.zoomToMaxExtent=function(H){this.zoomToExtent(s.OpenLayersOptions.initBounds)};s.baseLayer=s.initLocation?"mapabsas_"+s.initLocation.map:s.baseLayer;this.setBaseLayer(s.baseLayer);F.zoomToExtent(s.OpenLayersOptions.initBounds);if(s.initLocation){F.moveTo(new OpenLayers.LonLat(s.initLocation.lon,s.initLocation.lat),s.initLocation.zl)}else{F.zoomToExtent(s.OpenLayersOptions.initBounds)}scalebar=new OpenLayers.Control.ScaleBar({minWidth:141,maxWidth:142});F.addControl(scalebar);if(s.includePanZoomBar){panZoomBar=new OpenLayers.Control.PanZoomBar({panner:true,zoomWorldIcon:true,textAcercar:s.texts.panZoomBar.textAcercar,textAlejar:s.texts.panZoomBar.textAlejar,verMapaCompleto:s.texts.panZoomBar.verMapaCompleto});F.addControl(panZoomBar);overviewMap=new OpenLayers.Control.OverviewMap({layers:[new OpenLayers.Layer.WMS("Referencia",n("referencia"),{layers:s.overviewOptions.layer})],size:new OpenLayers.Size(s.overviewOptions.size[0],s.overviewOptions.size[1]),minRatio:12,maxRatio:24,mapOptions:{projection:s.OpenLayersOptions.projection,units:s.OpenLayersOptions.units,maxExtent:s.OpenLayersOptions.maxExtent,resolutions:s.overviewOptions.resolutions}});F.addControl(overviewMap)}if(s.includeToolbar){navBar=new OpenLayers.Control.NavToolbar(a.extend({},s.texts.navBar,{mapList:s.mapList,activeMap:s.baseLayer,mapSelectorText:s.texts.mapSelectorDefault,mapSelectorTrigger:(function(H){if(H!="none"){this.setBaseLayer(H)}else{this.setBaseLayer(s.baseLayer)}}).createDelegate(this),clickHandler:s.onMapClick,handleRightClicks:true,rightClickHandler:s.onMapClick}));F.addControl(navBar)}else{F.addControl(new OpenLayers.Control.Navigation())}statusBar=new OpenLayers.Control.StatusBar();F.addControl(statusBar);markersShadows=new OpenLayers.Layer.Vector("MarkersShadows",{styleMap:new OpenLayers.StyleMap({externalGraphic:s.rootUrl+"images/blank.gif",backgroundGraphic:s.rootUrl+"images/pincho_inclinado_shadow.png",graphicWidth:33,graphicHeight:10,graphicXOffset:-2,graphicYOffset:-29,backgroundXOffset:1,backgroundYOffset:-11,graphicZIndex:s.MARKER_Z_INDEX,backgroundGraphicZIndex:s.SHADOW_Z_INDEX,pointRadius:10}),rendererOptions:{yOrdering:true}});myMarkers=new OpenLayers.Layer.Markers("MyMarkers");F.addLayer(markersShadows);F.addLayer(myMarkers);if(typeof(s.onReady)=="function"){s.onReady(this)}if(s.trackVisits){var G=function(H){try{var J=Piwik.getTracker(s.piwikBaseUrl+"piwik.php",H);J.trackPageView();J.enableLinkTracking()}catch(I){}};if(typeof(Piwik)=="undefined"){usig.loadJs(s.piwikBaseUrl+"piwik.js",G.createDelegate(this,[s.piwikSiteId]))}else{G(s.piwikSiteId)}}}function m(){var G=usig.MapaInteractivo.defaults.OpenLayersJS.replace("OpenLayers.js","");a.each(s.preloadImages,function(I,H){y.push(a('<img src="'+G+H+'"/>'))})}function n(G){var H=new Array();a.each(s.servers,function(I,J){H.push(J+G)});return H}this.setOptions=function(G){s=a.extend({},s,G)};this.updateSize=function(){F.updateSize.defer(200,F)};this.getMarkers=function(){return myMarkers};this.setBaseLayer=function(H){var G=F.baseLayer;if(G==undefined){var J=n(H);F.addLayer(new OpenLayers.Layer.WMS(H,J,{layers:H,format:"image/png"},{transitionEffect:"resize",buffer:0}))}else{if(G.name!=H){var J=n(H);try{F.removeLayer(G)}catch(I){}F.addLayer(new OpenLayers.Layer.WMS(H,J,{layers:H,format:"image/png"},{transitionEffect:"resize",buffer:0}))}}if(navBar){navBar.selectMap(H)}};function t(G){if(G instanceof OpenLayers.Marker){return G}var H=new OpenLayers.Size(20,36),K=new OpenLayers.Pixel(-5,-H.h),I=new OpenLayers.Icon(s.rootUrl+"images/pincho_inclinado.png",H,K),J=null;if(G.options){H=new OpenLayers.Size(G.options.iconWidth,G.options.iconHeight);I=new OpenLayers.Icon(G.options.iconUrl,H)}if(G.x!=undefined&&G.y!=undefined){J=new OpenLayers.LonLat(G.x,G.y)}if(usig.Direccion&&G instanceof usig.Direccion){J=new OpenLayers.LonLat(G.getCoordenadas().x,G.getCoordenadas().y)}if(usig.inventario&&usig.inventario.Objeto&&G instanceof usig.inventario.Objeto){J=new OpenLayers.LonLat(G.ubicacion.getCentroide().x,G.ubicacion.getCentroide().y)}I.imageDiv.className="Marker";return new OpenLayers.Marker(J,I)}function c(){if(usig.NormalizadorDirecciones){h=false;if(usig.NormalizadorDirecciones.listo()){e()}else{usig.NormalizadorDirecciones.init({onReady:c.createDelegate(this),loadFullDatabase:true})}}else{if(!h){h=true;usig.loadJs(s.NormalizadorDireccionesJS,c.createDelegate(this))}}}function e(){var G=0;if(usig.NormalizadorDirecciones&&usig.NormalizadorDirecciones.listo()){a.each(d,function(L,K){try{var J=K.place;var H=usig.NormalizadorDirecciones.normalizar(J,10);if(H.length>0){K.place=H[0];p[L]={place:K.place,goTo:K.goTo,onClick:K.onClick,options:K.options};G++}}catch(I){}delete d[L]});if(G>0){j()}}else{c()}}function j(){if(z){a.each(p,function(I,H){var G=H.place;z.geoCodificarDireccion(G,function(J){H.place.setCoordenadas(J);B(H.place,I,H.goTo,H.onClick,H.options)});delete p[I]})}else{o()}}function o(){if(usig.GeoCoder){A=false;z=new usig.GeoCoder();j()}else{if(!A){A=true;usig.loadJs(s.GeoCoderJS,o.createDelegate(this))}}}function u(G,H){if(H){if(F.getZoom()==s.goToZoomLevel){F.panTo(new OpenLayers.LonLat(G.lon,G.lat))}else{F.moveTo(new OpenLayers.LonLat(G.lon,G.lat),s.goToZoomLevel)}}else{F.panTo(new OpenLayers.LonLat(G.lon,G.lat))}}function B(L,H,I,N,O){var K={iconUrl:s.rootUrl+"images/pincho_inclinado.png",iconWidth:20,iconHeight:36,offsetX:-5,offsetY:-36};statusBar.activate(s.texts.processing,true);if(O){L.options=a.extend({},K,O)}else{if(typeof(N)=="object"){L.options=a.extend({},K,N)}}var M=t(L);var J=L;if(N&&typeof(N)!="function"&&typeof(N)!="object"){J=N}M.place=L;k[""+H]=M;myMarkers.addMarker(M);if(!(L instanceof OpenLayers.Marker)&&(typeof(O)!="object")&&typeof(N)!="object"){var G=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(M.lonlat.lon,M.lonlat.lat));M.shadow=G;markersShadows.addFeatures(G)}M.events.registerPriority("click",M,function(Q){OpenLayers.Event.stop(Q,false);var P=new OpenLayers.Popup.FramedCloud(H,M.lonlat,new OpenLayers.Size(10,10),J,M.icon,true,null);M.popup=P;P.hide();F.addPopup(P,true);if(typeof(N)=="function"){N(Q,L,P)}else{P.show()}});statusBar.deactivate();if(I){u(M.lonlat,true)}return H}function x(J){var G=J.getPlan();var H=usig.GMLPlan.create("trip_plan_"+J.getId(),{template:J.getTemplate(),baseUrl:s.rootUrl});for(i=0;i<G.length;i++){var I=G[i];if(I.type!=undefined){if(I.type=="StartWalking"||I.type=="FinishWalking"){H.addMarker(I.gml)}else{if(I.type=="Board"){if(I.service_type=="1"){switch(I.service){case"Línea A":I.gml=I.gml.replace("subway","subwayA");break;case"Línea B":I.gml=I.gml.replace("subway","subwayB");break;case"Línea C":I.gml=I.gml.replace("subway","subwayC");break;case"Línea D":I.gml=I.gml.replace("subway","subwayD");break;case"Línea E":I.gml=I.gml.replace("subway","subwayE");break;case"Línea H":I.gml=I.gml.replace("subway","subwayH");break}}H.addMarker(I.gml)}else{if(I.type=="Bus"||I.type=="SubWay"||I.type=="Street"){H.addEdges([I.gml])}else{if(I.type=="SubWayConnection"){switch(I.service_to){case"Línea A":I.gml[1]=I.gml[1].replace("connection","subwayA");break;case"Línea B":I.gml[1]=I.gml[1].replace("connection","subwayB");break;case"Línea C":I.gml[1]=I.gml[1].replace("connection","subwayC");break;case"Línea D":I.gml[1]=I.gml[1].replace("connection","subwayD");break;case"Línea E":I.gml[1]=I.gml[1].replace("connection","subwayE");break;case"Línea H":I.gml[1]=I.gml[1].replace("connection","subwayH");break}H.addMarker(I.gml[1]);H.addEdges(I.gml)}}}}}}J.gmlLayer=H;return H}function g(I){var H=F.getLayersByName(I.gmlLayer.name);if(H.length>0){for(l=0;l<H.length;l++){H[l].setVisibility(true)}}else{var G=I.gmlLayer;F.addLayer(G)}F.zoomToExtent(I.gmlLayer.getDataExtent())}this.addMarker=function(G,J,K,H){var I=Math.floor(Math.random()*100001);var L=new Date()*1+I;if(typeof(G)=="string"){d[L]={place:G,goTo:J,onClick:K,options:H};e();return L}return B(G,L,J,K,H)};this.removeMarker=function(G){marker=k[""+G];if(marker.popup){F.removePopup(marker.popup);marker.popup.destroy()}myMarkers.removeMarker(marker);if(marker.shadow){markersShadows.removeFeatures(marker.shadow)}marker.destroy();marker=undefined;k[G]=undefined};this.toggleMarker=function(H,G){k[""+H].display(G);if(k[""+H].shadow){if(!G){markersShadows.removeFeatures(k[""+H].shadow)}else{markersShadows.addFeatures(k[""+H].shadow)}}};this.goTo=function(G,H){u(G,H)};this.showStatus=function(H,G){statusBar.activate(H,G)};this.hideStatus=function(){statusBar.deactivate()};this.raiseMarkers=function(G){F.raiseLayer(myMarkers,G)};this.getMarkersIndex=function(){return F.getLayerIndex(myMarkers)};this.getMarkersZIndex=function(){return myMarkers.getZIndex()};this.mostrarRecorrido=function(G){if(!G.gmlLayer){G.getPlan(function(){x(G);g(G)})}else{g(G)}};this.ocultarRecorrido=function(G){if(G.gmlLayer){G.gmlLayer.setVisibility(false)}};this.borrarRecorrido=function(G){if(G.gmlLayer){F.removeLayer(G.gmlLayer)}};if(typeof(OpenLayers)=="undefined"){q=a('<img src="'+s.rootUrl+'images/animated_indicator_medium.gif" alt="'+s.texts.loading+'"/>');q.css("padding","10px");b.css("background-color","#fff").css("width","52px").css("height","52px").css("border","1px solid #ddd").css("position","relative").css("left",(D/2-26)+"px").css("top",(w/2-26)+"px").append(q);E.css("background-color","#eee").append(b);usig.loadCss(s.OpenLayersCSS);usig.loadJs(s.OpenLayersJS,C.createDelegate(this));(function(){if(typeof(OpenLayers)=="undefined"){m()}}).defer(500,this)}else{C.defer(200,this)}}})(jQuery);usig.MapaInteractivo.defaults={debug:false,trackVisits:true,includePanZoomBar:true,includeToolbar:true,bounds:[54340,54090,172855,140146],initBounds:[93500,96750,112000,106750],OpenLayersOptions:{controls:[],resolutions:[90,50,30,15,7.5,4,2,1,0.5,0.2],projection:"EPSG:221951",units:"m"},baseLayer:"mapabsas_default",rootUrl:"http://servicios.usig.buenosaires.gov.ar/usig-js/2.3/",OpenLayersCSS:"http://servicios.usig.buenosaires.gov.ar/OpenLayers/2.9.1-6/theme/default/style.css",OpenLayersJS:"http://servicios.usig.buenosaires.gov.ar/OpenLayers/2.9.1-6/OpenLayers.js",NormalizadorDireccionesJS:"http://servicios.usig.buenosaires.gob.ar/nd-js/1.3/normalizadorDirecciones.min.js",GeoCoderJS:"http://servicios.usig.buenosaires.gob.ar/usig-js/2.3/usig.GeoCoder.min.js",piwikBaseUrl:"http://usig.buenosaires.gov.ar/piwik/",piwikSiteId:3,preloadImages:["img/panZoomBar/arriba.png","img/panZoomBar/izquierda.png","img/panZoomBar/abajo.png","img/panZoomBar/derecha.png","img/panZoomBar/centro.png","img/panZoomBar/bt_zoomin.gif","img/panZoomBar/bt_zoomout.gif","img/panZoomBar/bt_zoomworld.gif","img/panZoomBar/marcador_azul.gif","img/panZoomBar/zoomBar.png"],overviewOptions:{layer:"referencia",resolutions:[130,70,30,15,7.5,4],size:[195,130]},mapList:[{name:"mapabsas_imagen_satelital_2009",display:"Vista Satelital 2009",desc:"Mapa que incluye imagen satelital QuickBird, año de toma 2009. El mapa presenta la imagen satelital de alta resolución de la Ciudad de Buenos Aires con calles y alturas."},{name:"mapabsas_imagen_satelital_2004",display:"Vista Satelital 2004",desc:"Mapa que incluye imagen satelital QuickBird, año de toma 2004. El mapa presenta la imagen satelital de alta resolución de la Ciudad de Buenos Aires con calles y alturas."},{name:"mapabsas_fotografias_aereas_1978",display:"Vista Aérea 1978",desc:"Mapa que incluye una imagen de la ciudad restituida a partir de fotografías aéreas tomadas en el año 1978. El mapa presenta también la información de calles y alturas actuales como referencia."},{name:"mapabsas_fotografias_aereas_1965",display:"Vista Aérea 1965",desc:"Mapa que incluye una imagen de la ciudad restituida a partir de fotografías aéreas tomadas en el año 1965. El mapa presenta también la información de calles y alturas actuales como referencia."},{name:"mapabsas_fotografias_aereas_1940",display:"Vista Aérea 1940",desc:"Mapa que incluye una imagen de la ciudad restituida a partir de fotografías aéreas tomadas en el año 1940. El mapa presenta también la información de calles y alturas actuales como referencia."}],texts:{processing:"Procesando...",loading:"Cargando...",tituloMailing:"Enviar vista actual por e-mail",mapSelectorDefault:"Mapa",panZoomBar:{textAcercar:"Acercar",textAlejar:"Alejar",verMapaCompleto:"Ver el mapa completo"},overviewMap:{textMapaReferencia:"Mapa de referencia interactivo",textCerrar:"Cerrar"},navBar:{navigationText:"Mover",zoomBoxText:"Acercar",measureToolTexts:{buttonLabel:"Medir",measure:"Medida",measureDistance:"Medir Distancia",measureArea:"Medir Área"}}},goToZoomLevel:7,SHADOW_Z_INDEX:10,MARKER_Z_INDEX:11,servers:["http://tiles1.mapa.buenosaires.gob.ar/tilecache/","http://tiles2.mapa.buenosaires.gob.ar/tilecache/","http://tiles3.mapa.buenosaires.gob.ar/tilecache/","http://tiles4.mapa.buenosaires.gob.ar/tilecache/","http://tiles5.mapa.buenosaires.gob.ar/tilecache/","http://tiles6.mapa.buenosaires.gob.ar/tilecache/","http://tiles7.mapa.buenosaires.gob.ar/tilecache/"]};if(typeof(usig)=="undefined"){usig={}}usig.GMLPlan=(function(b){var a;return{create:function(d,c){if(!OpenLayers){throw ("ERROR: OpenLayers is not loaded.");return null}if(!a){a=OpenLayers.Class(OpenLayers.Layer.Vector,{format:null,formatOptions:null,loaded:false,edges:null,markers:null,styleMap:null,initialize:function(g,f){var e=[];this.styleMap=this.getStyle(f.template,f.baseUrl);e.push(g,{styleMap:this.styleMap});OpenLayers.Layer.Vector.prototype.initialize.apply(this,e);this.edges=new Array();this.markers=new Array()},loadFeatures:function(){var e={};OpenLayers.Util.extend(e,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){e.externalProjection=this.projection;e.internalProjection=this.map.getProjectionObject()}var f=this.format?new this.format(e):new OpenLayers.Format.GML(e);gml='<?xml version="1.0" encoding="utf-8"?><wfs:FeatureCollection xmlns:ms="http://mapserver.gis.umn.edu/mapserver" xmlns:wfs="http://www.opengis.net/wfs" xmlns:gml="http://www.opengis.net/gml">';gml+=this.edges.join();gml+=this.markers.join();gml+="</wfs:FeatureCollection>";this.loaded=true;this.addFeatures(f.read(gml));this.events.triggerEvent("loadend")},addMarker:function(e){this.markers.push("<gml:featureMember>"+e+"</gml:featureMember>")},addEdges:function(e){ls=this.edges;b.each(e,function(g,f){ls.push("<gml:featureMember>"+f+"</gml:featureMember>")})},setVisibility:function(e,f){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments);if(this.visibility&&!this.loaded){this.events.triggerEvent("loadstart");this.loadFeatures()}},moveTo:function(g,e,f){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.events.triggerEvent("loadstart");this.loadFeatures()}},getFeatureByAttrId:function(h){var g=null;for(var f=0,e=this.features.length;f<e;++f){if(this.features[f].attributes.fid==h){g=this.features[f];break}}return g},highlightFeature:function(e){this.drawFeature(e,this.styleMap.styles.select)},getStyle:function(e,f){defaultOpacity=0.8;lineOptions={strokeWidth:6,strokeOpacity:defaultOpacity};lineOptionsWalk={strokeWidth:4,strokeDashstyle:"dashdot",strokeOpacity:defaultOpacity};if(e.marker!=undefined){externalGraphic=f+"images/"+e.marker}else{externalGraphic=f+"images/pincho_inclinado.png"}color=e.color;styleMap=new OpenLayers.StyleMap(OpenLayers.Util.applyDefaults({fillColor:color,fillOpacity:1,strokeColor:color,strokeWidth:3,strokeOpacity:1},OpenLayers.Feature.Vector.style["default"]));var g={walk:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/recorrido_pie.png",graphicZIndex:5},Line:lineOptionsWalk},bus:{Point:{pointRadius:12,externalGraphic:f+"images/recorrido_colectivo.png",graphicWidth:35,graphicHeight:35,graphicZIndex:5},Line:lineOptions},car:{Point:{externalGraphic:f+"images/recorrido_auto.png",graphicWidth:35,graphicHeight:35,graphicZIndex:5},Line:lineOptions},subway:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/recorrido_subte.png",graphicZIndex:5},Line:lineOptions},subwayA:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/lineasubte41x41-a.png",graphicZIndex:5},Line:lineOptions},subwayB:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/lineasubte41x41-b.png",graphicZIndex:5},Line:lineOptions},subwayC:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/lineasubte41x41-c.png",graphicZIndex:5},Line:lineOptions},subwayD:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/lineasubte41x41-d.png",graphicZIndex:5},Line:lineOptions},subwayE:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/lineasubte41x41-e.png",graphicZIndex:5},Line:lineOptions},subwayH:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:f+"images/lineasubte41x41-h.png",graphicZIndex:5},Line:lineOptions},connection:{Point:{pointRadius:6},Line:{strokeWidth:8,strokeOpacity:defaultOpacity}},train:{Point:{pointRadius:12,externalGraphic:f+"images/recorrido_tren.png",graphicWidth:35,graphicHeight:35},graphicZIndex:5,Line:lineOptions},marker:{Point:{externalGraphic:externalGraphic,graphicYOffset:-20,graphicWidth:20,graphicHeight:36},graphicZIndex:5,Line:lineOptions}};styleMap.addUniqueValueRules("default","type",g);return styleMap},CLASS_NAME:"usig.GMLPlan"})}return new a(d,c)}}})(jQuery);